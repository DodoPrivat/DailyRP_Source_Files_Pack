local Keys = {
  ["ESC"] = 322, ["F1"] = 288, ["F2"] = 289, ["F3"] = 170, ["F5"] = 166, ["F6"] = 167, ["F7"] = 168, ["F8"] = 169, ["F9"] = 56, ["F10"] = 57,
  ["~"] = 243, ["1"] = 157, ["2"] = 158, ["3"] = 160, ["4"] = 164, ["5"] = 165, ["6"] = 159, ["7"] = 161, ["8"] = 162, ["9"] = 163, ["-"] = 84, ["="] = 83, ["BACKSPACE"] = 177,
  ["TAB"] = 37, ["Q"] = 44, ["W"] = 32, ["E"] = 38, ["R"] = 45, ["T"] = 245, ["Y"] = 246, ["U"] = 303, ["P"] = 199, ["["] = 39, ["]"] = 40, ["ENTER"] = 18,
  ["CAPS"] = 137, ["A"] = 34, ["S"] = 8, ["D"] = 9, ["F"] = 23, ["G"] = 47, ["H"] = 74, ["K"] = 311, ["L"] = 182,
  ["LEFTSHIFT"] = 21, ["Z"] = 20, ["X"] = 73, ["C"] = 26, ["V"] = 0, ["B"] = 29, ["N"] = 249, ["M"] = 244, [","] = 82, ["."] = 81,
  ["LEFTCTRL"] = 36, ["LEFTALT"] = 19, ["SPACE"] = 22, ["RIGHTCTRL"] = 70,
  ["HOME"] = 213, ["PAGEUP"] = 10, ["PAGEDOWN"] = 11, ["DELETE"] = 178,
  ["LEFT"] = 174, ["RIGHT"] = 175, ["TOP"] = 27, ["DOWN"] = 173,
  ["NENTER"] = 201, ["N4"] = 108, ["N5"] = 60, ["N6"] = 107, ["N+"] = 96, ["N-"] = 97, ["N7"] = 117, ["N8"] = 61, ["N9"] = 118
}

local GUI                     = {}
local PlayerData              = {}
local HasAlreadyEnteredMarker = false
local LastZone                = nil
local CurrentAction           = nil
local CurrentActionMsg        = ''
local CurrentActionData       = {}

ESX                           = nil
GUI.Time                      = 0

Citizen.CreateThread(function()
  while ESX == nil do
    TriggerEvent('esx:getSharedObject', function(obj) ESX = obj end)
    Citizen.Wait(0)
  end
end)

function OpenRealestateAgentMenu()

  local elements = {
    {label = _U('properties'), value = 'properties'},
    {label = _U('clients'),    value = 'customers'},
  }

  if PlayerData.job ~= nil and PlayerData.job.name == 'realestateagent' and PlayerData.job.grade_name == 'boss' then
    table.insert(elements, {label = _U('boss_action'), value = 'boss_actions'})
  end

  ESX.UI.Menu.CloseAll()

  ESX.UI.Menu.Open(
    'default', GetCurrentResourceName(), 'realestateagent',
    {
      title    = _U('realtor'),
      elements = elements
    },
    function(data, menu)

      if data.current.value == 'properties' then
        OpenPropertyMenu()
      end

      if data.current.value == 'customers' then
        OpenCustomersMenu()
      end

      if data.current.value == 'boss_actions' then
        TriggerEvent('esx_society:openBossMenu', 'realestateagent', function(data, menu)
          menu.close()
        end, {wash = false})
      end

    end,
    function(data, menu)

      menu.close()

      CurrentAction     = 'realestateagent_menu'
      CurrentActionMsg  = _U('press_to_access')
      CurrentActionData = {}

    end
  )

end

function OpenPropertyMenu()

  TriggerEvent('esx_property:getProperties', function(properties)

    local elements = {
      head = {_U('property'), 'Actions'},
      rows = {}
    }

    for i=1, #properties, 1 do
      table.insert(elements.rows, {
        data = properties[i],
        cols = {
          properties[i].label,
          _U('property_actions')
        }
      })
    end

    ESX.UI.Menu.Open(
      'list', GetCurrentResourceName(), 'properties',
      elements,
      function(data, menu)

        if data.value == 'sell' then

          menu.close()

          ESX.UI.Menu.Open(
            'dialog', GetCurrentResourceName(), 'sell_property_amount',
            {
              title = _U('amount')
            },
            function(data2, menu)

              local amount = tonumber(data2.value)

              if amount == nil then
                ESX.ShowNotification(_U('invalid_amount'))
              else

                menu.close()

                local closestPlayer, closestDistance = ESX.Game.GetClosestPlayer()

                if closestPlayer == -1 or closestDistance > 3.0 then
                  ESX.ShowNotification(_U('no_play_near'))
                else
                  TriggerServerEvent('esx_realestateagentjob:sell', GetPlayerServerId(closestPlayer), data.data.name, amount)
                end

                OpenPropertyMenu()

              end

            end,
            function(data2, menu)
              menu.close()
            end
          )

        end

        if data.value == 'rent' then

          menu.close()

          ESX.UI.Menu.Open(
            'dialog', GetCurrentResourceName(), 'rent_property_amount',
            {
              title = _U('amount')
            },
            function(data2, menu)

              local amount = tonumber(data2.value)

              if amount == nil then
                ESX.ShowNotification(_U('invalid_amount'))
              else

                menu.close()

                local closestPlayer, closestDistance = ESX.Game.GetClosestPlayer()

                if closestPlayer == -1 or closestDistance > 3.0 then
                  ESX.ShowNotification(_U('no_play_near'))
                else
                  TriggerServerEvent('esx_realestateagentjob:rent', GetPlayerServerId(closestPlayer), data.data.name, amount)
                end

                OpenPropertyMenu()

              end

            end,
            function(data2, menu)
              menu.close()
            end
          )

        end

        if data.value == 'gps' then

          TriggerEvent('esx_property:getProperty', data.data.name, function(property)

            if property.isSingle then
              SetNewWaypoint(property.entering.x,  property.entering.y)
            else
              TriggerEvent('esx_property:getGateway', property, function(gateway)
                SetNewWaypoint(gateway.entering.x,  gateway.entering.y)
              end)
            end

          end)

        end

      end,
      function(data, menu)
        menu.close()
      end
    )

  end)

end

function OpenCustomersMenu()

  ESX.TriggerServerCallback('esx_realestateagentjob:getCustomers', function(customers)

    local elements = {
      head = {'Client', _U('property'), 'Type', 'Actions'},
      rows = {}
    }

    for i=1, #customers, 1 do
      table.insert(elements.rows, {
        data = customers[i],
        cols = {
          customers[i].name,
          customers[i].propertyName,
          (customers[i].propertyRented and _U('rent') or _U('sell')),
          _U('contract')
        }
      })
    end

    ESX.UI.Menu.Open(
      'list', GetCurrentResourceName(), 'customers',
      elements,
      function(data, menu)

        if data.value == 'revoke' then
          TriggerServerEvent('esx_realestateagentjob:revoke', data.data.propertyName, data.data.propertyOwner)
          OpenCustomersMenu()
        end

        if data.value == 'gps' then

          TriggerEvent('esx_property:getProperty', data.data.propertyName, function(property)

            if property.isSingle then
              SetNewWaypoint(property.entering.x,  property.entering.y)
            else
              TriggerEvent('esx_property:getGateway', property, function(gateway)
                SetNewWaypoint(gateway.entering.x,  gateway.entering.y)
              end)
            end

          end)

        end

      end,
      function(data, menu)
        menu.close()
      end
    )

  end)

end

RegisterNetEvent('esx:playerLoaded')
AddEventHandler('esx:playerLoaded', function(xPlayer)

  PlayerData = xPlayer

  if PlayerData.job.name == 'realestateagent' then
    Config.Zones.OfficeActions.Type = 1
  else
    Config.Zones.OfficeActions.Type = -1
  end

end)

RegisterNetEvent('esx:setJob')
AddEventHandler('esx:setJob', function(job)

  PlayerData.job = job

  if PlayerData.job.name == 'realestateagent' then
    Config.Zones.OfficeActions.Type = 1
  else
    Config.Zones.OfficeActions.Type = -1
  end

end)

AddEventHandler('esx_realestateagentjob:hasEnteredMarker', function(zone)

  if zone == 'OfficeEnter' then
    local playerPed = GetPlayerPed(-1)
    SetEntityCoords(playerPed,  Config.Zones.OfficeInside.Pos.x,  Config.Zones.OfficeInside.Pos.y,  Config.Zones.OfficeInside.Pos.z)
  end

  if zone == 'OfficeExit' then
    local playerPed = GetPlayerPed(-1)
    SetEntityCoords(playerPed,  Config.Zones.OfficeOutside.Pos.x,  Config.Zones.OfficeOutside.Pos.y,  Config.Zones.OfficeOutside.Pos.z)
  end

  if zone == 'OfficeActions' and PlayerData.job ~= nil and PlayerData.job.name == 'realestateagent' then
    CurrentAction     = 'realestateagent_menu'
    CurrentActionMsg  = _U('press_to_access')
    CurrentActionData = {}
  end

end)

AddEventHandler('esx_realestateagentjob:hasExitedMarker', function(zone)
  ESX.UI.Menu.CloseAll()
  CurrentAction = nil
end)

RegisterNetEvent('esx_phone:loaded')
AddEventHandler('esx_phone:loaded', function(phoneNumber, contacts)

  local specialContact = {
    name       = _U('realtor'),
    number     = 'realestateagent',
    base64Icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAYAAADnRuK4AAAACXBIWXMAAAsTAAALEwEAmpwYAAA4JmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cyk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMTgtMDctMjVUMDE6MTI6MTMrMDI6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxOC0wNy0yNVQwMToxOTozOCswMjowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTgtMDctMjVUMDE6MTk6MzgrMDI6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2UvcG5nPC9kYzpmb3JtYXQ+CiAgICAgICAgIDxwaG90b3Nob3A6Q29sb3JNb2RlPjM8L3Bob3Rvc2hvcDpDb2xvck1vZGU+CiAgICAgICAgIDx4bXBNTTpJbnN0YW5jZUlEPnhtcC5paWQ6MzAxOTY0NDgtZGU4ZS05NDQ5LWFjNmEtMzU5ZGZlY2VjZTQwPC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOjMwMTk2NDQ4LWRlOGUtOTQ0OS1hYzZhLTM1OWRmZWNlY2U0MDwveG1wTU06RG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD54bXAuZGlkOjMwMTk2NDQ4LWRlOGUtOTQ0OS1hYzZhLTM1OWRmZWNlY2U0MDwveG1wTU06T3JpZ2luYWxEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06SGlzdG9yeT4KICAgICAgICAgICAgPHJkZjpTZXE+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9uPmNyZWF0ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDozMDE5NjQ0OC1kZThlLTk0NDktYWM2YS0zNTlkZmVjZWNlNDA8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMTgtMDctMjVUMDE6MTI6MTMrMDI6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpzb2Z0d2FyZUFnZW50PkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE3IChXaW5kb3dzKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpIaXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTQ0PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjE0NDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg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'
  }

  TriggerEvent('esx_phone:addSpecialContact', specialContact.name, specialContact.number, specialContact.base64Icon)

end)

-- Create Blips
Citizen.CreateThread(function()

  local blip = AddBlipForCoord(Config.Zones.OfficeEnter.Pos.x, Config.Zones.OfficeEnter.Pos.y, Config.Zones.OfficeEnter.Pos.z)

  SetBlipSprite (blip, 50)
  SetBlipDisplay(blip, 4)
  SetBlipScale  (blip, 1.0)
  SetBlipColour (blip, 4)
  SetBlipAsShortRange(blip, true)

  BeginTextCommandSetBlipName("STRING")
  AddTextComponentString(_U('realtors'))
  EndTextCommandSetBlipName(blip)

end)

-- Display markers
Citizen.CreateThread(function()
  while true do

    Wait(0)

    local coords = GetEntityCoords(GetPlayerPed(-1))

    for k,v in pairs(Config.Zones) do
      if(v.Type ~= -1 and GetDistanceBetweenCoords(coords, v.Pos.x, v.Pos.y, v.Pos.z, true) < Config.DrawDistance) then
        DrawMarker(v.Type, v.Pos.x, v.Pos.y, v.Pos.z, 0.0, 0.0, 0.0, 0, 0.0, 0.0, v.Size.x, v.Size.y, v.Size.z, Config.MarkerColor.r, Config.MarkerColor.g, Config.MarkerColor.b, 100, false, true, 2, false, false, false, false)
      end
    end

  end
end)

-- Enter / Exit marker events
Citizen.CreateThread(function()
  while true do

    Wait(0)

    local coords      = GetEntityCoords(GetPlayerPed(-1))
    local isInMarker  = false
    local currentZone = nil

    for k,v in pairs(Config.Zones) do
      if(GetDistanceBetweenCoords(coords, v.Pos.x, v.Pos.y, v.Pos.z, true) < v.Size.x) then
        isInMarker  = true
        currentZone = k
      end
    end

    if (isInMarker and not HasAlreadyEnteredMarker) or (isInMarker and LastZone ~= currentZone) then
      HasAlreadyEnteredMarker = true
      LastZone                = currentZone
      TriggerEvent('esx_realestateagentjob:hasEnteredMarker', currentZone)
    end

    if not isInMarker and HasAlreadyEnteredMarker then
      HasAlreadyEnteredMarker = false
      TriggerEvent('esx_realestateagentjob:hasExitedMarker', LastZone)
    end

  end
end)

-- Key controls
Citizen.CreateThread(function()
  while true do

    Citizen.Wait(0)

    if CurrentAction ~= nil then

      SetTextComponentFormat('STRING')
      AddTextComponentString(CurrentActionMsg)
      DisplayHelpTextFromStringLabel(0, 0, 1, -1)

      if IsControlPressed(0,  Keys['E']) and (GetGameTimer() - GUI.Time) > 300 then

        if CurrentAction == 'realestateagent_menu' then
          OpenRealestateAgentMenu()
        end

        CurrentAction = nil
        GUI.Time      = GetGameTimer()

      end

    end

  end
end)

-- Load IPLS
Citizen.CreateThread(function()
  LoadMpDlcMaps()
  EnableMpDlcMaps(true)
  RequestIpl('ex_dt1_02_office_02c')
end)
